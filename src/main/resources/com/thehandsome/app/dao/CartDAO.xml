<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
		"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.thehandsome.app.dao.CartDAO">

	<select id="getCartList" parameterType="String"
		resultType="CartDTO">
		<![CDATA[
		SELECT Cart.userId, Cart.productId, Cart.quantity, Cart.sizelabel, Cart.color, ProductColor.imagepath, Brand.name as brandName, Product.title, Product.price, Product.sex, Product.mainCategoryid, Product.subCategoryid
		FROM Cart, ProductColor, Product, Brand
		WHERE cart.userId = #{userId} and cart.productId like Product.id and product.brandId = brand.id and cart.productId like ProductColor.productId and cart.color=productColor.color
		]]>
	</select>

	<insert id="insertCart" parameterType="CartDTO">
		INSERT INTO
		Cart(user_id, product_id, quantity, color, sizelabel)
		VALUES(#{user_id}, #{product_id}, #{quantity}, #{color}, #{sizelabel})
	</insert>

	<delete id="deleteCart" parameterType="CartDTO">
		DELETE FROM Cart
		WHERE user_id = #{user_id} and product_id = #{product_id}
	</delete>

	<update id="updateCart" parameterType="CartDTO">
		UPDATE Cart SET
		color = #{color}, sizelabel = #{sizelabel}
		where user_id = #{user_id} and product_id = #{product_id}
	</update>
	
	<update id="updateQuantity" parameterType="CartDTO">
		UPDATE Cart SET
		quantity = #{quantity}
		where user_id = #{user_id} and product_id = #{product_id}
	</update>
</mapper>